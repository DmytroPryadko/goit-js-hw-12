{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst pixabayAPI = {\n  url: 'https://pixabay.com/api/',\n  key: '44811580-9eab9f49684dd01a2a36a0ef4',\n};\n\nexport async function searchImage({ query = '', page = 1, pageSize = 5 } = {}) {\n  try {\n    const response = await axios.get(`${pixabayAPI.url}`, {\n      params: {\n        key: pixabayAPI.key,\n        q: query,\n        image_type: 'photo',\n        orient: 'horizontal',\n        safeSearch: true,\n        page,\n        per_page: pageSize,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nexport const btnLoad = document.querySelector('.js-load-more');\n\nexport function createGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  const markup = images\n    .map(\n      image =>\n        `<li class=\"img-wrap\">\n        <a href=\"${image.largeImageURL}\">\n          <img\n            src=\"${image.webformatURL}\"\n            alt=\"${image.tags}\"\n          />\n        </a>\n        <div class=\"gallery-info-wrapper\">\n          <div class=\"info-likes\">\n            <p class=\"title\">Likes</p>\n            <p class=\"subtitle\">${image.likes}</p>\n          </div>\n          <div class=\"info-views\">\n            <p class=\"title\">Views</p>\n            <p class=\"subtitle\">${image.views}</p>\n          </div>\n          <div class=\"info-comments\">\n            <p class=\"title\">Comments</p>\n            <p class=\"subtitle\">${image.comments}</p>\n          </div>\n          <div class=\"info-downloads\">\n            <p class=\"title\">Downloads</p>\n            <p class=\"subtitle\">${image.downloads}</p>\n          </div>\n        </div>\n      </li>\n          `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    overlayOpacity: 0.8,\n  }).refresh();\n}\n\nexport function clearGallery() {\n  const gallery = document.querySelector('.gallery');\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  const loader = document.querySelector('.loader-wrapp');\n  loader.classList.remove('hide');\n}\n\nexport function hideLoader() {\n  const loader = document.querySelector('.loader-wrapp');\n  loader.classList.add('hide');\n}\n\nexport function showLoadMore() {\n  btnLoad.classList.remove('hide');\n}\n\nexport function hideLoadMore() {\n  btnLoad.classList.add('hide');\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { searchImage } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMore,\n  hideLoadMore,\n  btnLoad,\n} from './js/render-functions';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const searchForm = document.querySelector('.form');\n\n  const params = {\n    query: '',\n    page: 1,\n    pageSize: 15,\n    totalResults: 0,\n  };\n\n  searchForm.addEventListener('submit', searchFormEvt);\n\n  async function searchFormEvt(e) {\n    clearGallery();\n    params.page = 1;\n    e.preventDefault();\n    const form = e.target;\n    params.query = form.elements.query.value.trim();\n    if (params.query === '') {\n      iziToast.error({\n        backgroundColor: '#EF4040',\n        message: 'Please fill the form',\n        titleColor: '#fff',\n        messageColor: '#fff',\n        progressBarColor: '#B51B1B',\n      });\n      return;\n    }\n\n    try {\n      const data = await searchImage(params);\n\n      params.totalResults = data.totalHits;\n\n      params.maxPage = Math.ceil(params.totalResults / params.pageSize);\n\n      if (data.hits.length === 0) {\n        iziToast.error({\n          backgroundColor: '#EF4040',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          titleColor: '#fff',\n          messageColor: '#fff',\n          progressBarColor: '#B51B1B',\n        });\n        hideLoader();\n        hideLoadMore();\n        return;\n      } else {\n        showLoader();\n        createGallery(data.hits);\n      }\n\n      if (data.hits.length >= 15) {\n        showLoadMore();\n      } else {\n        hideLoadMore();\n      }\n    } catch (error) {\n      console.log(error);\n      iziToast.error({\n        backgroundColor: '#EF4040',\n        message: 'Sorry, something goes wrong. Please, try again later!',\n        titleColor: '#fff',\n        messageColor: '#fff',\n        progressBarColor: '#B51B1B',\n      });\n    } finally {\n      hideLoader();\n    }\n\n    form.reset();\n  }\n\n  btnLoad.addEventListener('click', handleLoadMore);\n\n  async function handleLoadMore() {\n    params.page += 1;\n\n    showLoader();\n    hideLoadMore();\n\n    try {\n      const data = await searchImage(params);\n      createGallery(data.hits);\n\n      const galleryItem = document.querySelector('.img-wrap');\n      const galleryItemHeight = galleryItem.getBoundingClientRect().height;\n      window.scrollBy({ top: galleryItemHeight * 2, behavior: 'smooth' });\n    } catch (error) {\n      console.log(error);\n      iziToast.error({\n        backgroundColor: '#EF4040',\n        message: 'Sorry, something goes wrong. Please, try again later!',\n        titleColor: '#fff',\n        messageColor: '#fff',\n        progressBarColor: '#B51B1B',\n      });\n    } finally {\n      hideLoader();\n      showLoadMore();\n    }\n\n    if (params.page === params.maxPage) {\n      hideLoadMore();\n      iziToast.error({\n        backgroundColor: '#EF4040',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        titleColor: '#fff',\n        messageColor: '#fff',\n        progressBarColor: '#B51B1B',\n      });\n      btnLoad.removeEventListener('click', handleLoadMore);\n    }\n  }\n});"],"names":["pixabayAPI","searchImage","query","page","pageSize","axios","error","btnLoad","createGallery","images","gallery","markup","image","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMore","hideLoadMore","searchForm","params","searchFormEvt","form","iziToast","data","handleLoadMore","galleryItemHeight"],"mappings":"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"}